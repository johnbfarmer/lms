import{r as o,j as e,P as J}from"./app-DMNfrNhn.js";import{A as Ee}from"./AuthenticatedLayout-CK2JEpOV.js";import{G as De,F as G,a as W}from"./index-D-pQ_u0A.js";import{C as z}from"./Checkbox-Hj_pvAtN.js";import{S as $e,F as Ve,H as Be}from"./HintComponent-CqGszS4n.js";import{T as Re}from"./TopMenu-CY_O2CwH.js";import{S as E}from"./react-select.esm-BgOafunv.js";import{I as qe}from"./InputError-BX4_ni9E.js";import{M as Ze}from"./Modal-DkJ05YuX.js";import{M as Oe}from"./index-Bpl7TPNI.js";import{b as Qe,h as We}from"./Utilities-m0eG5Gao.js";import"./ApplicationLogo-0j7nhg8-.js";import"./transition-CpjbZLWG.js";import"./index-ChdDc4Yc.js";import"./HybridDisplay-CqQcAzRR.js";import"./TextInput-CtSk-fS6.js";import"./InputLabel-CVPUTz-D.js";import"./index-DNms_AyM.js";function ze(t){return De({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",strokeWidth:"2",d:"M1,1 L19,1 L19,19 L1,19 L1,1 Z M5,19 L5,23 L23,23 L23,5.97061363 L18.9998921,5.97061363 M6,8 C6.55228475,8 7,7.55228475 7,7 C7,6.44771525 6.55228475,6 6,6 C5.44771525,6 5,6.44771525 5,7 C5,7.55228475 5.44771525,8 6,8 Z M2,18 L7,12 L10,15 L14,10 L19,16"},child:[]}]})(t)}function Je(t){const[d,u]=o.useState(t.selected),p=t.lessons.map(c=>({key:c.id,value:c.id,label:c.name}));let b=null;p.some(c=>c.value==t.selected?(b=c,!0):!1);const g=c=>{u(c.value),t.onSelect(c)};return e.jsx("div",{className:"py-2",children:e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center bg-white p-1 shadow w-full sm:rounded-lg sm:p-8 flex",children:[e.jsx("div",{className:"w-50%",children:"Lesson:"}),t.lessons.length>0&&e.jsx("div",{className:"w-full",children:e.jsx(E,{options:p,placeholder:"Select a Lesson...",onChange:g,isClearable:!0,defaultValue:b})})]})})})}function Ke(t){const[d,u]=o.useState(t.selected),[p,b]=o.useState([]);o.useEffect(()=>{fetch(route("chapter.lessons",{id:d})).then(n=>n.json()).then(n=>{b(n)},n=>{console.log("error",n)})},[d]);const g=t.chapters.map(n=>({key:n.id,value:n.id,label:n.name}));let c=null;g.some(n=>n.value==t.selected?(c=n,!0):!1);const f=n=>{u(n.value)};return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center bg-white p-1 shadow w-full sm:rounded-lg sm:p-8 flex",children:[e.jsx("div",{className:"w-50%",children:"Chapter:"}),t.chapters.length>0&&e.jsx("div",{className:"w-full",children:e.jsx(E,{options:g,placeholder:"Select a chapter...",onChange:f,isClearable:!0,defaultValue:c})})]})}),e.jsx(Je,{lessons:p,selected:t.lessonId,onSelect:t.onSelectLesson})]})}function Ue(t){const[d,u]=o.useState(t.selected),[p,b]=o.useState([]),[g,c]=o.useState(t.chapterId),f=t.courses.map(r=>({key:r.id,value:r.id,label:r.name}));let n=null;f.some(r=>r.value==t.selected?(n=r,!0):!1),o.useEffect(()=>{fetch(route("course.chapters",{id:d})).then(r=>r.json()).then(r=>{b(r),c(0)},r=>{console.log("error",r)})},[d]);const x=r=>{u(r.value),t.onSelectCourse(r)},C=r=>{c(r.value),t.onSelectChapter(r)};return e.jsxs("div",{className:"py-2",children:[e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center bg-white p-1 shadow w-full sm:rounded-lg sm:p-8 flex",children:[e.jsx("div",{className:"w-50%",children:"Course:"}),t.courses.length>0&&e.jsx("div",{className:"w-full",children:e.jsx(E,{options:f,placeholder:"Select a course...",onChange:x,isClearable:!0,defaultValue:n})})]})}),e.jsx(Ke,{chapters:p,selected:g||t.chapterId,onSelectChapter:C,onSelectLesson:t.onSelectLesson,lessonId:t.lessonId})]})}function Xe(t){const{data:d,setData:u,post:p}=J({courseId:t.course.id,file:null,imageName:""}),b=n=>{p(route("image.upload"),{data:d,onSuccess:x=>{console.log(x)}}),n.preventDefault()},g=n=>{let x={...d};x.file=n.target.files[0],x.imageName=n.target.files[0].name,u(x)},c=n=>{let x={...d};x.imageName=n.target.value,u(x)},f=t.images.map((n,x)=>e.jsxs("div",{className:"max-w-[300px] m-2 overflow-x-hide",onClick:()=>t.addImageToProb(n),children:[e.jsx("div",{className:"m-2",children:e.jsx("img",{src:n,width:50,height:50})}),e.jsx("div",{className:"m-2",children:n.replace("/storage/"+t.course.id+"/thumbs/","")})]},x));return e.jsx("div",{className:"mx-auto my-6 w-7xl space-y-6 sm:px-6 lg:px-8 h-screen",children:e.jsx(Ze,{show:t.show,onClose:t.onClose,children:e.jsxs("div",{className:"bg-white p-4 shadow sm:rounded-lg",children:[e.jsx(Oe,{className:"float-right cursor-pointer",onClick:t.onClose}),e.jsxs("div",{className:"h-fit",children:[e.jsxs("div",{className:"text-lg text-center",children:["Galería Curso ",t.course.name]}),e.jsx("div",{className:"py-2",children:e.jsx("input",{type:"file",onChange:g,className:"w-full",placeholder:"upload image..."})}),e.jsx("div",{className:"py-2 w-1/2",children:e.jsx("input",{type:"text",value:d.imageName,onChange:c,className:"w-full",placeholder:"image name"})}),e.jsx("div",{className:"mx-auto w-24 text-center my-4 sm:px-4 space-y-6 lg:px-8 cursor-pointer border border-black bg-white px-6 shadow sm:rounded-lg",onClick:b,children:e.jsx("div",{className:"",children:"Subir"})}),e.jsx("div",{className:"flex flex-wrap overflow-y-scroll",children:f})]})]})})})}const gs=({auth:t,origProblem:d,origAnswers:u,origHints:p,courses:b,origCourseId:g,origChapterId:c,origLessonId:f,lesson:n,chapter:x,course:C,images:r})=>{const[L,D]=o.useState(d.problem_text),[$,K]=o.useState(d.display_type),[T,U]=o.useState(d.problem_type_id),[k,X]=o.useState(d.active),[h,P]=o.useState(d),[v,y]=o.useState(u),[w,_]=o.useState(p||[]),[Y,ee]=o.useState(g),[se,te]=o.useState(c),[S,le]=o.useState(f),[ae,ne]=o.useState(""),[oe,I]=o.useState(!1),[re,ce]=o.useState(0),[M,H]=o.useState(!1),[V,B]=o.useState(!1),[F,ie]=o.useState(1),{data:m,setData:j,post:de,errors:R}=J({problem:h,answers:v,hints:w||[],lessonId:S});o.useEffect(()=>{console.log("prob",h);let s={...h},l={...m};s.problem_text=L,P(s),l.problem=s,j(l)},[L,$,T,k,S]);const me="id"in h?`${h.id}`:"New Problem",q=()=>{P(h),I(!1),H(!1)},Z=()=>{I(!1),H(!M)},O=()=>{ie(F+1)},xe=(s,l,a)=>{ne(a),I(!0),ce(l)},he=()=>{I(!1)},ue=()=>{H(!1)},pe=()=>{B(!1)},be=s=>{let l=s.target.value;D(l)},ge=(s,l)=>{let a=s.target.value;T===4&&(a=We(a));let i=[...v];i[l].answer_text=a,y(i),m.answers=i,j(m)},fe=(s,l)=>{s.target.value;let a=[...v];a[l].is_correct=!a[l].is_correct,y(a),m.answers=a,j(m)},je=()=>{let s=[...v];s.push({problem_id:h.id,sequence_id:(s.length+1)*10,answer_text:"",is_correct:0,display_type:"latex"}),y(s),m.answers=s,j(m)},ve=(s,l)=>{let a=[...v];a.splice(l,1),y(a),m.answers=a,j(m)},we=(s,l)=>{let a=s.target.value,i=[...w];i[l].hint=a,_(i),m.hints=i,j(m)},Ne=()=>{let s=[...w];s.push({problem_id:h.id,sequence_id:(s.length+1)*10,hint:""}),_(s),m.hints=s,j(m)},Ce=(s,l)=>{let a=[...w];a.splice(l,1),_(a),m.hints=a,j(m)},ye=()=>{de(route("problem.save"),{data:m})},Se=s=>{ee(s.value)},Ie=s=>{te(s.value)},Le=s=>{le(s.value)},Te=s=>{K(s)},ke=s=>{U(s)},Pe=()=>{X(!k)},Q=()=>{B(!V)},_e=()=>{confirm("Really delete this problem?")&&alert("TBI")},Me=Qe({course:C,chapter:x,lesson:n},4);let He=e.jsx(Re,{auth:t,title:me,lessonId:S,problemId:h.id,show:["home","prob-set","prob-add","prob-dup"],breadcrumbs:Me}),Fe=["latex","text","hybrid"].map(s=>{let l=s===$?"font-bold":"text-slate-500";return e.jsx("div",{className:`cursor-pointer text-sm mx-1 ${l}`,onClick:()=>Te(s),children:s},s)}),Ae=["single MC","multiple MC","text","numeric"].map((s,l)=>{let a=l+1,i=a===T?"font-bold":"text-slate-500";return e.jsx("div",{className:`cursor-pointer text-sm mx-1 ${i}`,onClick:()=>ke(a),children:s},s)});const Ge=s=>{let l={...h},a=l.problem_text,i='<img src="'+s.replace("/thumbs","")+`" alt='image'/>`;l.display_type==="latex"&&(l.display_type="hybrid",P(l),a="[LLL] "+a),l.display_type==="hybrid"?a=a+" [HHH] "+i:a=a+i,Q(),D(a)};let A="";for(let s in R)A=A+R[s];return e.jsxs(Ee,{auth:t,user:t.user,header:!1,topMenu:He,children:[e.jsx("div",{className:"py-2",children:e.jsxs("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center bg-white p-1 shadow text-2xl sm:rounded-lg sm:p-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"",children:" Question:"}),e.jsx("div",{className:"flex items-center mx-2",children:Fe}),e.jsx("div",{className:"flex items-center mx-2",children:Ae}),e.jsxs("div",{className:"flex items-center mx-2",children:[e.jsx(z,{checked:k,onChange:Pe,className:"border border-black border-1"}),e.jsx("div",{className:"text-sm ml-1 mr-2",children:"Publicar"}),e.jsx(ze,{className:"text-base mx-2 cursor-pointer",onClick:Q,title:"galería de imágenes"}),e.jsx(G,{className:"text-base ml-2 cursor-pointer",onClick:_e,title:"borrar problema"})]})]}),e.jsx("input",{type:"text",onChange:be,value:L,className:"w-full"})]}),e.jsx(qe,{message:A,className:"mt-2"})]})}),e.jsx("div",{className:"py-2",children:e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center bg-white p-1 shadow text-2xl sm:rounded-lg sm:p-8",children:[e.jsxs("div",{className:"flex items-center",children:[" Answers: ",e.jsx(W,{className:"text-base ml-2 cursor-pointer",onClick:je})]}),v.map((s,l)=>{let a=s.answer_text,i=s.is_correct;return e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",onChange:N=>ge(N,l),value:a,className:"w-full"},l),e.jsx(z,{checked:i,onChange:N=>fe(N,l),className:"border border-black border-1"}),e.jsx(G,{className:"text-base ml-2 cursor-pointer",onClick:N=>ve(N,l)})]},l)})]})})}),e.jsx("div",{className:"py-2",children:e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center bg-white p-1 shadow text-2xl sm:rounded-lg sm:p-8",children:[e.jsxs("div",{className:"flex items-center",children:[" Hints: ",e.jsx(W,{className:"text-base ml-2 cursor-pointer",onClick:Ne})]}),w.map((s,l)=>{let a=s.hint;return e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",onChange:i=>we(i,l),value:a,className:"w-full"},l),e.jsx(G,{className:"text-base ml-2 cursor-pointer",onClick:i=>Ce(i,l)})]},`hnt_${l}`)})]})})}),e.jsx("div",{className:"py-2",children:e.jsx("div",{className:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8",children:e.jsx("div",{className:"text-center bg-white p-1 shadow text-2xl sm:rounded-lg sm:p-8 cursor-pointer",onClick:ye,children:"SAVE"})})}),h!==null&&e.jsx($e,{problem:h,answers:v,handleAnswer:xe,showHint:M,hint:Z,totalHints:w.length,hintsToShow:F,nextHint:O,next:()=>{},prev:()=>{},hasNextProblem:!1,hasPrevProblem:!1}),h!==null&&e.jsx(Ve,{show:oe,feedback:ae,points:re,next:q,hint:Z,hasNextProblem:!1,onClose:he}),h!==null&&e.jsx(Be,{show:M,hints:w,next:q,onClose:ue,hintsToShow:F,nextHint:O}),e.jsx(Xe,{show:V,onClose:pe,course:C,images:r,addImageToProb:Ge}),e.jsx(Ue,{courses:b,selected:Y,onSelectCourse:Se,onSelectChapter:Ie,onSelectLesson:Le,chapterId:se,lessonId:S})]})};export{gs as default};
